@if (_loading)
{
    <MudProgressCircular Color="Color.Default" Indeterminate="true" />
}
else
{
    <MudText Typo="Typo.h6">@L["Closed Questions"]</MudText>
    <MudSpacer />
    <MudGrid Spacing="0" Class="d-flex justify-space-between">
        <MudItem xs="12" md="5">
            <MudSelect T="string" Label=@L["Select Category"] MultiSelection="true" OffsetY="true" @bind-SelectedValues="Cats">
                @foreach (var cat in _categories)
                {
                    @if (ShareResource.IsEn())
                    {
                        <MudSelectItem T="string" Value="@cat.Name" />
                    }
                    else
                    {
                        <MudSelectItem T="string" Value="@cat.NamePl" />
                    }
                }
            </MudSelect>
        </MudItem>
        <MudItem xs="12" md="5">
            <MudTextField @bind-Value="_searchString"
                      Placeholder=@L["Search"]
                      Adornment="Adornment.Start"
                      Immediate="true"
                      AdornmentIcon="@Icons.Material.Filled.Search"
                      IconSize="Size.Medium"></MudTextField>
        </MudItem>
    </MudGrid>
    <MudDataGrid T="ClosedQuestionVM" Items="@(GetQuestions())" Sortable="true" Dense="true" Hover="true" Bordered="false" Striped="false" Breakpoint="Breakpoint.Sm" QuickFilter="@QuickFilter" @bind-SelectedItem="_selectedItem1">
        <ToolBarContent>
            <MudText Typo="Typo.body2">&nbsp;&nbsp;&nbsp;@L["Selected Categories"]:&nbsp;&nbsp;&nbsp; </MudText>
            @foreach (var cat in Cats)
            {
                @if (!string.IsNullOrEmpty(cat))
                {
                        <MudButton Color="Color.Primary" Size="Size.Small" Variant="Variant.Outlined" OnClick="@(()=>CategoryUpdate(cat))">@L[@cat]</MudButton>
          
                    <MudText>&nbsp;&nbsp;&nbsp;</MudText>
                }
            }
            <MudSpacer />
        </ToolBarContent>
        <Columns>
            @if (ShareResource.IsEn())
            {
                <Column Field="CategoryId" T="ClosedQuestionVM" Title=" Category Id" />
                <Column Field="CategoryName" T="ClosedQuestionVM" Title="Category">
                    <HeaderTemplate>
                        @L["Category"] <MudIconButton OnClick="@(()=>CategoryCreate())" Size="Size.Small" Variant=Variant.Outlined Color="Color.Primary" Icon="@Icons.Outlined.Add" />
                    </HeaderTemplate>
                </Column>
                <Column Field="ClosedQuestionId" T="ClosedQuestionVM" Title="Question Id" />
                <Column Field="QuestionName" T="ClosedQuestionVM" Title="Question" />
                <Column Field="IsActive" T="ClosedQuestionVM" Title="Active">
                    <CellTemplate>
                        @(context.IsActive?"Yes":"No")
                    </CellTemplate>
                </Column>
                <Column Field="Description" T="ClosedQuestionVM" Title="Description" />
                <Column Sortable="false" T="ClosedQuestionVM" Title="Actions">
                    <CellTemplate>
                        @if (context.ClosedQuestionId > 0)
                        {
                            <MudButton Color="Color.Primary" OnClick="@(()=>QuestionDialog(context))" Size="Size.Small"
                           Variant="Variant.Outlined">@L["Edit Question"]</MudButton>
                        }else{
<MudButton Color="Color.Info" OnClick="@(()=>QuestionDialog(context))">@L["New Question"]</MudButton>
                        }
                    </CellTemplate>
                </Column>
            }
            else
            {
                <Column Field="CategoryId" T="ClosedQuestionVM" Title="Id Kategorii" />
                <Column T="ClosedQuestionVM" Field="CategoryNamePl" Title="Kategoria">
                    <HeaderTemplate>
                        @L["Category"] <MudIconButton OnClick="@(()=>CategoryCreate())" Size="Size.Small" Variant=Variant.Outlined Color="Color.Primary" Icon="@Icons.Outlined.Add" />
                    </HeaderTemplate>
                </Column>
                <Column Field="ClosedQuestionId" T="ClosedQuestionVM" Title="Id Pytania" />
                <Column Field="QuestionNamePl" T="ClosedQuestionVM" Title="Pytanie" />
                <Column Field="IsActive" T="ClosedQuestionVM" Title="Aktywne">
                    <CellTemplate>
                        @(context.IsActive?"Tak":"Nie")
                    </CellTemplate>
                </Column>
                <Column Field="DescriptionPl" T="ClosedQuestionVM" Title="Opis" />
                <Column Sortable="false" T="ClosedQuestionVM" Title="Działania">
                    <CellTemplate>
                         @if (context.ClosedQuestionId > 0)
                        {
                            <MudButton Color="Color.Primary" OnClick="@(()=>QuestionDialog(context))" Size="Size.Small"
                           Variant="Variant.Outlined">@L["Edit Question"]</MudButton>
                        }else{
<MudButton Color="Color.Info" OnClick="@(()=>QuestionDialog(context))">@L["New Question"]</MudButton>
                        }
                    </CellTemplate>
                </Column>
            }
        </Columns>
        <PagerContent>
            <MudDataGridPager T="ClosedQuestionVM" Class="pl-2 pr-2" PageSizeOptions="new int[] { 5, 10, 25, 50, 100 }" RowsPerPageString=@L["Rows per page"]
                          InfoFormat="{first_item}-{last_item} / {all_items}" />
        </PagerContent>
    </MudDataGrid>
}
<style>
    .mud-tabs-panels {
        min-height: 200px !important;
    }
</style>